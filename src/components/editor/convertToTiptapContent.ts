const data = {
    "success": true,
    "code": 20000,
    "message": "请求成功",
    "data": {
        "data": [
            // page
            {
                "block_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "block_type": "page",
                "parent_id": "",
                "content": {
                    "style": {
                        "align": 1
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "测试文档",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [
                    "ZTRAd7Q65oOP6gxie15cn4FLnFk",
                    "BfY4dvKuaoJg9FxjltNcqOS8nfh",
                    "CLtNdLTMBodjQGxHIjuc5uc9n0c",
                    "NdbbdGBKyo9R2Lxx6PncYU6ynKg",
                    "NMYtdf0DZoB3FTxoH3ZclQPjnAf",
                    "QEaodHDy6oUy3exHtk4cJGponad",
                    "Rzaqdw2f9oHzJ1xvggGckiWTnke",
                    "U1kYdlIySot9IixYl2MczVRSnVf",
                    "XFzDdUp1coghEqxdQcxcBEH1nhe",
                    "RlabdOiYnoQbMFxJWQoclQtyngg",
                    "DoeudhARTo7ggCxozpucw2lYn2c",
                    "Iqk2del4boGFbSxz4Gnc9adKnBc",
                    "M7YNdlGeMoEcApxr8JWcDkRFncc",
                    "TmR0drlqzoGcAexQLT6c2ipinzd",
                    "B21gdanJDoVcEfxRclGciTe0nUe",
                    "HpEidUGGHoi3L5xAXhWcMsAbnBb",
                    "CxL6dMnwdoHsrJxbPxNcFs6cnAh",
                    "QLojdYYjVoz6vLxfFOEc2qe6nYf",
                    "UNHNdkbNpokCmkx9dEEcXrzenBg",
                    "GHyxd7zeaomCbIxdvFkc5DvFnXg",
                    "Jc0yd0NA6oGUcqxc1lCcECCBnbf",
                    "CPmoduKGGo48sGxW0zjcpLOHnkg",
                    "Db2mdOCc0ozEbUxCw5rcoXH1nVb",
                    "KygmdSZSCs5h9SbiqcRcbXUOnvd",
                    "LvQNdmfVWoWiCBxxvEjcnx1pnAf",
                    "L3O2d6Ljioztftxk0d6ckE6rntg"
                ],
                "block_histories": []
            },

            // heading
            {
                "block_id": "ZTRAd7Q65oOP6gxie15cn4FLnFk",
                "block_type": "heading1",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "style": {
                        "align": 1,
                        "folded": false
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "一级标题块",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },
            {
                "block_id": "CLtNdLTMBodjQGxHIjuc5uc9n0c",
                "block_type": "heading2",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "style": {
                        "align": 1,
                        "folded": false
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "二级标题块",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },
            {
                "block_id": "NdbbdGBKyo9R2Lxx6PncYU6ynKg",
                "block_type": "heading3",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "style": {
                        "align": 1,
                        "folded": false
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "三级标题块",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },
            {
                "block_id": "NMYtdf0DZoB3FTxoH3ZclQPjnAf",
                "block_type": "heading4",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "style": {
                        "align": 1,
                        "folded": false
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "四级标题块",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },
            {
                "block_id": "QEaodHDy6oUy3exHtk4cJGponad",
                "block_type": "heading5",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "style": {
                        "align": 1,
                        "folded": false
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "五级标题块",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },
            {
                "block_id": "Rzaqdw2f9oHzJ1xvggGckiWTnke",
                "block_type": "heading6",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "style": {
                        "align": 1,
                        "folded": false
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "六级标题块",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },

            // text
            {
                "block_id": "U1kYdlIySot9IixYl2MczVRSnVf",
                "block_type": "text",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "style": {
                        "align": 2,
                        "folded": false
                    },
                    
                    "elements": [
                        {
                            "text_run": {
                                "content": "告别2023年，拥抱2024年，让我们带着",
                                "text_element_style": {
                                    "bold": true,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        },
                        {
                            "text_run": {
                                "content": "坚实",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": true,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false,
                                }
                            }
                        },
                        {
                            "text_run": {
                                "content": "、",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": true,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        },
                        {
                            "text_run": {
                                "content": "力量",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": true,
                                    "strikethrough": false
                                }
                            }
                        },
                        {
                            "text_run": {
                                "content": "、",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        },
                        {
                            "text_run": {
                                "content": "神采",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": true
                                }
                            }
                        },
                        {
                            "text_run": {
                                "content": "、",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        },
                        {
                            "text_run": {
                                "content": "底气",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false,
                                    "background_color": '#FF0000',
                                    "text_color": '#facc15'
                                }
                            }
                        },
                        {
                            "text_run": {
                                "content": "这四个词再出发，大家一起迈出新步伐，以自身的确定性应对形势变化的不确定性。",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },

            // bullet
            {
                "block_id": "BfY4dvKuaoJg9FxjltNcqOS8nfh",
                "block_type": "text",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "style": {
                        "align": 1,
                        "folded": false
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "下面是无序列表块：",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },
            {
                "block_id": "XFzDdUp1coghEqxdQcxcBEH1nhe",
                "block_type": "bullet",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "style": {
                        "align": 1,
                        "folded": false
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "无序列表1",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },

            // ordered list
            {
                "block_id": "RlabdOiYnoQbMFxJWQoclQtyngg",
                "block_type": "text",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "style": {
                        "align": 1,
                        "folded": false
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "下面是有序列表块：",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },
            {
                "block_id": "DoeudhARTo7ggCxozpucw2lYn2c",
                "block_type": "ordered",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "style": {
                        "align": 1,
                        "folded": false,
                        "sequence": "1"
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "有序列表1",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },

            // code
            {
                "block_id": "Iqk2del4boGFbSxz4Gnc9adKnBc",
                "block_type": "text",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "style": {
                        "align": 1,
                        "folded": false
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "下面是代码块",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },
            {
                "block_id": "M7YNdlGeMoEcApxr8JWcDkRFncc",
                "block_type": "code",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "style": {
                        "wrap": false,
                        "language": 7
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "<p>hello world</p>",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },

            // divider
            {
                "block_id": "TmR0drlqzoGcAexQLT6c2ipinzd",
                "block_type": "text",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "style": {
                        "align": 1,
                        "folded": false
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "下面是分割线块",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },
            {
                "block_id": "B21gdanJDoVcEfxRclGciTe0nUe",
                "block_type": "divider",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {},
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },
    
            // quote_container
            {
                "block_id": "HpEidUGGHoi3L5xAXhWcMsAbnBb",
                "block_type": "text",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "style": {
                        "align": 1,
                        "folded": false
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "下面是引用块",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },
            {
                "block_id": "CxL6dMnwdoHsrJxbPxNcFs6cnAh",
                "block_type": "quote_container",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {},
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [
                    "DGEWd4bd0oF0eXxz5yFcn81Ln5g"
                ],
                "block_histories": []
            },
            {
                "block_id": "DGEWd4bd0oF0eXxz5yFcn81Ln5g",
                "block_type": "text",
                "parent_id": "CxL6dMnwdoHsrJxbPxNcFs6cnAh",
                "content": {
                    "style": {
                        "align": 1,
                        "folded": false
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "引用模块，不知道引用了什么",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },

            // image
            {
                "block_id": "QLojdYYjVoz6vLxfFOEc2qe6nYf",
                "block_type": "text",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "style": {
                        "align": 1,
                        "folded": false
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "下面是图片模块",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },
            {
                "block_id": "UNHNdkbNpokCmkx9dEEcXrzenBg",
                "block_type": "image",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "align": 2,
                    // "token": "BkiybBC0Vod5rWxqgmIc38DFnoq",
                    "token": "https://cdn.pixabay.com/photo/2024/12/20/11/53/architect-9280053_1280.jpg",
                    "width": 2139,
                    "height": 1284
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },

            // table
            {
                "block_id": "GHyxd7zeaomCbIxdvFkc5DvFnXg",
                "block_type": "text",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "style": {
                        "align": 1,
                        "folded": false
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "下面是表格块",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },
            {
                "block_id": "Jc0yd0NA6oGUcqxc1lCcECCBnbf",
                "block_type": "table",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "cells": [
                        "LPEldutVuouIG3xdTXVcU1Wln6c",
                        "Zoa1d9hCHolv9rxlCnCcu65Bnxc",
                        "G1drdKrykobrWuxHxQVc0RDSngc",
                        "YX2KduxARosAO2xg4GjcP6lwnyl",
                        "QDS7djTGQokevRx6MKPchC9fnSc",
                        "JXR8delvloTzjexw5Ejcfnnxn9c"
                    ],
                    "property": {
                        "row_size": 3,
                        "merge_info": [
                            {
                                "col_span": 1,
                                "row_span": 1
                            },
                            {
                                "col_span": 2,
                                "row_span": 2
                            },
                            {
                                "col_span": 1,
                                "row_span": 1
                            },
                            // {
                            //     "col_span": 1,
                            //     "row_span": 1
                            // },
                            {
                                "col_span": 2,
                                "row_span": 1
                            },
                            {
                                "col_span": 1,
                                "row_span": 1
                            },
                        ],
                        "column_size": 3,
                        "column_width": [
                            252,
                            202,
                            194
                        ]
                    }
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [
                    "LPEldutVuouIG3xdTXVcU1Wln6c",
                    "Zoa1d9hCHolv9rxlCnCcu65Bnxc",
                    "G1drdKrykobrWuxHxQVc0RDSngc",
                    "YX2KduxARosAO2xg4GjcP6lwnyl",
                    "QDS7djTGQokevRx6MKPchC9fnSc",
                    "JXR8delvloTzjexw5Ejcfnnxn9c"
                ],
                "block_histories": []
            },
            {
                "block_id": "LPEldutVuouIG3xdTXVcU1Wln6c",
                "block_type": "table_cell",
                "parent_id": "Jc0yd0NA6oGUcqxc1lCcECCBnbf",
                "content": {},
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [
                    "F4nydc9w3oBMXyxfCKIcQgXHnih"
                ],
                "block_histories": []
            },
            {
                "block_id": "F4nydc9w3oBMXyxfCKIcQgXHnih",
                "block_type": "text",
                "parent_id": "LPEldutVuouIG3xdTXVcU1Wln6c",
                "content": {
                    "style": {
                        "align": 1,
                        "folded": false
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "单元格1居左",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": true,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 500,
                "created_at": "2025-01-03 13:16:59",
                "updated_at": "2025-01-03 13:16:59",
                "node_ids": [],
                "block_histories": []
            },
            {
                "block_id": "Zoa1d9hCHolv9rxlCnCcu65Bnxc",
                "block_type": "table_cell",
                "parent_id": "Jc0yd0NA6oGUcqxc1lCcECCBnbf",
                "content": {},
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [
                    "Qrs2dVHJLoEjSvxe5xUcZAPDn1d"
                ],
                "block_histories": []
            },
            {
                "block_id": "Qrs2dVHJLoEjSvxe5xUcZAPDn1d",
                "block_type": "text",
                "parent_id": "Zoa1d9hCHolv9rxlCnCcu65Bnxc",
                "content": {"elements":[{"text_run":{"content":"单元格2居中","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":2,"folded":false}},
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },
            {
                "block_id": "G1drdKrykobrWuxHxQVc0RDSngc",
                "block_type": "table_cell",
                "parent_id": "Jc0yd0NA6oGUcqxc1lCcECCBnbf",
                "content": {},
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [
                    "OHFYd3ti3oCFYOxz0E6cRiuRnoc"
                ],
                "block_histories": []
            },
            {
                "block_id": "OHFYd3ti3oCFYOxz0E6cRiuRnoc",
                "block_type": "text",
                "parent_id": "G1drdKrykobrWuxHxQVc0RDSngc",
                "content": {"elements":[{"text_run":{"content":"单元格3居右","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":3,"folded":false}},
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [
              
                ],
                "block_histories": []
            },
            {
                "block_id": "YX2KduxARosAO2xg4GjcP6lwnyl",
                "block_type": "table_cell",
                "parent_id": "Jc0yd0NA6oGUcqxc1lCcECCBnbf",
                "content": {},
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [
                    "EInUdXy4soBf4zxAjz9cIY6znhd"
                ],
                "block_histories": []
            },
            {
                "block_id": "EInUdXy4soBf4zxAjz9cIY6znhd",
                "block_type": "text",
                "parent_id": "YX2KduxARosAO2xg4GjcP6lwnyl",
                "content": {
                    "elements":[
                        {
                            "text_run":{"content":"单元格4居左并顶部对齐",
                            "text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}
                        }
                    ],
                    "style":{"align":1,"folded":false}
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },
            {
                "block_id": "QDS7djTGQokevRx6MKPchC9fnSc",
                "block_type": "table_cell",
                "parent_id": "Jc0yd0NA6oGUcqxc1lCcECCBnbf",
                "content": {},
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [
                    "UqM8dgADXolhq5xQmfjcuQB4nee"
                ],
                "block_histories": []
            },
            {
                "block_id": "UqM8dgADXolhq5xQmfjcuQB4nee",
                "block_type": "text",
                "parent_id": "QDS7djTGQokevRx6MKPchC9fnSc",
                "content": {
                    "elements":[
                        {
                            "text_run":{
                                "content":"单元格5居中并底部对齐",
                                "text_element_style":{
                                    "bold":false,
                                    "inline_code":false,
                                    "italic":false,
                                    "strikethrough":false,
                                    "underline":false
                                }
                            }
                        }
                    ],
                    "style":{
                        "align": 2,
                        "folded": false
                    }
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [
                ],
                "block_histories": []
            },
            {
                "block_id": "JXR8delvloTzjexw5Ejcfnnxn9c",
                "block_type": "table_cell",
                "parent_id": "Jc0yd0NA6oGUcqxc1lCcECCBnbf",
                "content": {},
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [
                    "VotKdw5zaoZtHvxzgZ8cLmuUnPf"
                ],
                "block_histories": []
            },
            {
                "block_id": "VotKdw5zaoZtHvxzgZ8cLmuUnPf",
                "block_type": "text",
                "parent_id": "JXR8delvloTzjexw5Ejcfnnxn9c",
                "content": {"elements":[{"text_run":{"content":"单元格右对齐并垂直居中","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":3,"folded":false}},
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [
  
                ],
                "block_histories": []
            },

            // link
            {
                "block_id": "CPmoduKGGo48sGxW0zjcpLOHnkg",
                "block_type": "text",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "style": {
                        "align": 1,
                        "folded": false
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "下面是链接预览",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },
            {
                "block_id": "Db2mdOCc0ozEbUxCw5rcoXH1nVb",
                "block_type": "text",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "style": {
                        "align": 1,
                        "folded": false
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "解螺旋官网",
                                "text_element_style": {
                                    "bold": false,
                                    "link": {
                                        "url": "https%3A%2F%2Fwww.helixlife.cn"
                                    },
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },

            {
                "block_id": "KygmdSZSCs5h9SbiqcRcbXUOnvd",
                "block_type": "undefined",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {},
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [
                    "KLUBdpM9UoZ1PexD2WHcxeu7nGe"
                ],
                "block_histories": []
            },

            // callout
            {
                "block_id": "KygmdSZSCs5h9SbiqcRcbXUOnvd",
                "block_type": "callout",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "emoji_id": "snowboarder",
                    "text_color": '#ff0000',
                    "border_color": '#0000ff',
                    "style": {
                        "align": 2,
                    },
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [
                    "XjpgdnfeGol23rxTV4Dc9jPenqb"
                ],
                "block_histories": []
            },
            {
                "block_id": "XjpgdnfeGol23rxTV4Dc9jPenqb",
                "block_type": "text",
                "parent_id": "KLUBdpM9UoZ1PexD2WHcxeu7nGe",
                "content": {
                    "style": {
                        "align": 1,
                        "folded": false
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "一键配置仪表盘，人人都可以是业务高手！",
                                "text_element_style": {
                                    "bold": true,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        },
                        {
                            "text_run": {
                                "content": "\n",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        },
                        {
                            "text_run": {
                                "content": "数据实时刷新，定时推送数据报告到群，让业务从这里起飞",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "text_color": 7,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 500,
                "created_at": "2025-01-03 13:16:59",
                "updated_at": "2025-01-03 13:16:59",
                "node_ids": [],
                "block_histories": []
            },

            {
                "block_id": "LvQNdmfVWoWiCBxxvEjcnx1pnAf",
                "block_type": "text",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "style": {
                        "align": 1,
                        "folded": false
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            },
            {
                "block_id": "L3O2d6Ljioztftxk0d6ckE6rntg",
                "block_type": "text",
                "parent_id": "URg9dmL0eovUh8x53WYcWYK1nns",
                "content": {
                    "style": {
                        "align": 1,
                        "folded": false
                    },
                    "elements": [
                        {
                            "text_run": {
                                "content": "",
                                "text_element_style": {
                                    "bold": false,
                                    "italic": false,
                                    "underline": false,
                                    "inline_code": false,
                                    "strikethrough": false
                                }
                            }
                        }
                    ]
                },
                "sort": 0,
                "created_at": "",
                "updated_at": "",
                "node_ids": [],
                "block_histories": []
            }
        ],
        "has_more": true
    }
}

interface TextRunStyle {
    bold: boolean;
    italic: boolean;
    underline: boolean;
    inline_code: boolean;
    strikethrough: boolean;
    text_color?: string;
    background_color?: string;
    link?: { url: string };
}

interface TextRun {
    content: string;
    text_element_style: TextRunStyle;
}

interface TextElement {
    text_run: TextRun;
}

interface ContentStyle {
    align: number;
    folded: boolean;
    sequence?: string;
    language?: number;
}

interface TProperty {
    row_size: number;
    col_size: number;
    merge_info: {row_span: number, col_span: number}[];
    column_width: number[];
    column_size: number;
}

interface Content {
    style: ContentStyle;
    elements: TextElement[];
    emoji_id?: string;
    text_color?: string;
    border_color?: string;
    token?: string;
    width?: number;
    height?: number;
    cells?: string[];
    property?: TProperty;
    colspan?: number;
    rowspan?: number;
    colwidth?: number[];
}

interface Block {
    block_id: string;
    block_type: string;
    parent_id: string;
    content: Content;
    sort: number;
    created_at: string;
    updated_at: string;
    node_ids: string[];
    block_histories: any[];
}

interface TNode {
    type: string;
    [key: string]: any;
}

const headingMatch = (blockType: string) => blockType.match(/^heading(\d+)$/);

const getAlignment = (align: number) => {
  switch (align) {
    case 1:
      return 'left';
    case 2:
      return 'center';
    case 3:
      return 'right';
    default:
      return 'left';
  }
}

const getMarks = (style: TextRunStyle) => {
  const marks = [];
  if (style.bold) marks.push({ type: 'bold' });
  if (style.italic) marks.push({ type: 'italic' });
  if (style.underline) marks.push({ type: 'underline' });
  if (style.strikethrough) marks.push({ type: 'strike' });
  if (style.inline_code) marks.push({ type: 'code' });
  if (style.text_color) marks.push({ type: 'textStyle', attrs: { color: style.text_color }});
  if (style.background_color) marks.push({ type: 'highlight', attrs: { color: style.background_color } });
  if (style.link) marks.push({ type: "link", attrs: { href: decodeURIComponent(style.link.url) } });
  return marks.length > 0 ? marks : undefined;
}

const mergeInfoToGrid = (mergeInfo: any[], rowSize: number, columnSize: number, columnWidth: number[]) => {
    const grid = Array.from({ length: rowSize }, () => Array(columnSize).fill(-1));
    let currentNumber = 0;

    for (let r = 0; r < rowSize; r++) {
        loop:for (let c = 0; c < columnSize; c++) {
            if (grid[r][c] === -1) {
                const merge = mergeInfo[currentNumber];

                if (!merge) {
                    return grid;
                }

                for (let i = 0; i < merge.row_span; i++) {
                    for (let j = 0; j < merge.col_span; j++) {
                        if (r + i >= rowSize || c + j >= columnSize || grid[r + i][c + j] !== -1) {
                            continue loop;
                        }
                    }
                }

                for (let i = 0; i < merge.row_span; i++) {
                    for (let j = 0; j < merge.col_span; j++) {
                        if (i === 0 && j === 0) {
                            grid[r][c] = {
                                index: currentNumber,
                                rowspan: merge.row_span,
                                colspan: merge.col_span,
                                colwidth: columnWidth.slice(c, c + merge.col_span)
                            }
                        } else {
                            grid[r + i][c + j] = 1;
                        }
                    }
                }
                currentNumber++;
            }
        }
    }

    for (let i = 0; i < grid.length; i++) {
        grid[i] = grid[i].filter(value => value !== -1 && value !== 1)
    }

    return grid;
}

const getLanguage = (languageId: ContentStyle['language']) => {
    switch (languageId) {
        case 7:
            return 'html';
        default:
            return 'plaintext';
    }
    
}

const getTextContent = (elements: TextElement[]) => {
    return  elements.filter(element => element.text_run.content)
        .map(element => ({
            type: 'text',
            text: element.text_run.content,
            marks: getMarks(element.text_run.text_element_style)
        }))
}

function convertToTiptapContent(blocks: Block[]) {
    const convertBlock = (block: Block) => {
        const blockType = block.block_type;
        const content = block.content || {};
        const style = content.style || {};
        const elements = content.elements || [];

        switch (blockType) {
            case 'page':
                return {
                    type: 'doc',
                    content: []
                };
            case 'heading1':
            case 'heading2':
            case 'heading3':
            case 'heading4':
            case 'heading5':
            case 'heading6':
                const level = parseInt(headingMatch(blockType)![1]);
                return  {
                    type: "heading",
                    attrs: { level, textAlign: getAlignment(style.align) },
                    content: getTextContent(elements)
                };
            case 'text':
                return {
                    type: 'paragraph',
                    attrs: { textAlign: getAlignment(style.align) },
                    content: getTextContent(elements)
                };
            case 'bullet':
                return {
                    type: 'bulletList',
                    content: elements.map(element => ({
                        type: 'listItem',
                        content: [{
                            type: 'paragraph',
                            attrs: { textAlign: getAlignment(style.align) },
                            content: getTextContent([element]),
                        }]
                    }))
                };
            case 'ordered':
                return {
                    type: 'orderedList',
                    attrs: { start: parseInt(style.sequence || '1'), textAlign: getAlignment(style.align) },
                    content: elements.map(element => ({
                        type: 'listItem',
                        content: [{
                            type: 'paragraph',
                            attrs: { textAlign: getAlignment(style.align) },
                            content: getTextContent([element]),
                        }]
                    }))
                };
            case 'code':
                return {
                    type: 'codeBlock',
                    attrs: { language: getLanguage(style.language) },
                    content: getTextContent(elements)
                };
            case 'divider':
                return {
                    type: 'horizontalRule'
                };
            case 'quote_container':
                const quoteContent: Block[] = [];
                block.node_ids.forEach(nodeId => {
                    blocks.forEach(subBlock => {
                        if (subBlock.block_id === nodeId) {
                            const convertedBlock = convertBlock(subBlock);
                            if (convertedBlock) {
                                quoteContent.push(convertedBlock as unknown as Block);
                            }
                        }
                    });
                });

                return {
                    type: 'blockquote',
                    content: quoteContent
                };
            case 'image':
                return {
                    type: 'image',
                    attrs: {
                        src: `${content.token}`,
                        width: content.width,
                        height: content.height,
                        align: getAlignment(style.align)
                    }
                };
            case 'table': {
                if (!content.cells || !content.property) {
                    return;
                }
                const { cells, property } = content;
                const { row_size, merge_info, column_size, column_width } = property;
                const table: TNode = {
                    type: "table",
                    content: []
                };

                const tableData = mergeInfoToGrid(merge_info, row_size, column_size, column_width);

                tableData.map((item) => {
                    const row: TNode = {
                        type: "tableRow",
                        content: []
                    };

                    item.forEach((cell) => {
                        const { index, rowspan, colspan, colwidth } = cell;
                        blocks.forEach(subBlock => {
                            if (subBlock.block_id === cells[index]) {
                                const cellContent: TNode = convertBlock(subBlock)!;
            
                                cellContent.attrs = {
                                    colspan,
                                    rowspan,
                                    colwidth
                                };

                                row.content.push(cellContent);
                            }
                        });
                    });
                    table.content.push(row);
                })
                return table;
            }
            case 'table_cell':
                const cellContent: Block[] = [];
                block.node_ids.forEach(nodeId => {
                    blocks.forEach(subBlock => {
                        if (subBlock.block_id === nodeId) {
                            cellContent.push(convertBlock(subBlock) as unknown as Block);
                        }
                    });
                });

                return {
                    type: "tableCell",
                    content: cellContent
                };
            case 'callout':
                const calloutContent: Block[] = [];
                block.node_ids.forEach(nodeId => {
                    blocks.forEach(subBlock => {
                        if (subBlock.block_id === nodeId) {
                            const convertedBlock = convertBlock(subBlock);
                            if (convertedBlock) {
                                calloutContent.push(convertedBlock as unknown as Block);
                            }
                        }
                    });
                });

                return {
                    type: 'callout',
                    attrs: {
                        emoji: content.emoji_id,
                        textColor: content.text_color,
                        borderColor: content.border_color,
                        textAlign: getAlignment(style.align)
                    },
                    content: calloutContent
                };
            default:
                console.warn(`Block type ${block.block_type} is not supported.`);
                return;
        }
    }

    let tiptapContent: TNode = { type: "doc", content: [] };
    const pageBlock = blocks.find(block => block.block_type === "page");
    
    if (pageBlock) {
        tiptapContent = convertBlock(pageBlock) || tiptapContent;
        blocks
            .filter(block => block.parent_id === pageBlock.block_id)
            .forEach(block => {
                const convertedBlock = convertBlock(block);
                if (convertedBlock) {
                    tiptapContent.content.push(convertedBlock);
                }
            });
    }
    
    return tiptapContent;
}

export const result = convertToTiptapContent(data.data.data as Block[]);
